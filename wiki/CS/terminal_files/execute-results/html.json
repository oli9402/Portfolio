{
  "hash": "07bc577f6fd935eadab3df55c98489be",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntite: Terminal Commands\ntitle: Convert Excel File into textfile\n---\n\n\n\n\n\nWe are using following [dataset](https://naehrwertdaten.ch/de/downloads/) and MAC terminal.\n\nUsing Pyhton to convert to semicolon text\n\nOn mac: `pip install openpyxl`.\n\nNext we convert the excel file into a new semicolon text file with help of chatgpt:\n\n- Change directory in terminal the folder containing excel file\n\n\n```{pyhton}\n#| eval: false\n\npython3 -c \"\nimport csv\nimport openpyxl\n\nwb = openpyxl.load_workbook('Schweizer_Nahrwertdatenbank.xlsx')\nsheet = wb.active\n\nwith open('output.txt', 'w', newline='') as f:\n    writer = csv.writer(f, delimiter=';')\n    for row in sheet.iter_rows(values_only=True):\n        writer.writerow(row)\n\"\n\n```\n\n\n\nWe check the first three lines of s_nw.csv with \n\n- `$ head -n 3 output.txt`\n\nSince the first two lines are not needed we delete them for further processing\n\n- `sed -i '' '1,2d' output.txt`\n\nWith excel we explore which column we need for our dashboard: \n\n- 4: name of product\n- 6: category of product\n- 8: unit\n- 9: energy (kJ)\n- 12: energy, calories (kcal)\n- 15: fett, total(g)\n- 18: fettsäure, gesättigt(g)\n- 21: fettsäure, einfach ungesättigt(g)\n- 24: fettsäure, mehrfach ungesättigt(g)\n- 27: cholesterin (mg)\n- 30: kohlenhydrate, verfügbar(g)\n- 33: zucker(g)\n- 36: stärke (g)\n- 39: nahrungsfasern(g)\n- 42: Protein (g)\n- 45: salz (g)\n- 48: alkohol(g)\n- 51: wasser (g)\n- 54: Vitamin A-Aktivität, RE (µg-RE)\n- 57: Vitamin A-Aktivität, RAE (µg-RE)\n- 60: Retinol (µg)\n- 63: Betacarotin-Aktivität (µg-BCE)\n- 66: Betacarotin (µg)\n- 69: Vitamin B1 (Thiamin) (mg)\n- 72: Vitamin B2 (Riboflavin) (mg)\n- 75: Vitamin B6 (Pyridoxin) (mg)\n- 78: Vitamin B12 (Cobalamin) (µg)\n- 81: Niacin (mg)\n- 84: Folat (µg)\n- 87: Pantothensäure (mg)\n- 90: Vitamin C (Ascorbinsäure) (mg)\n- 93: Vitamin D (Calciferol) (µg) \n- 96: Vitamin E (α-Tocopherol) (mg)\n- 99: Kalium (K) (mg)\n- 102: Natrium (Na) (mg)\n- 105: Chlorid (Cl) (mg)\n- 108: Calcium (Ca) (mg)\n- 111: Magnesium (Mg) (mg)\n- 114: Phosphor (P) (mg)\n- 117: Eisen (Fe) (mg)\n- 120: Jod (I) (µg)\n- 123: Zink (Zn)  (mg)\n- 126: Selen (Se) (µg)\n\nSince we have some columns with format \"...,...\" (e.g, energy, calories(csv)) we had to convert the file into semicolon text rather than csv, since the `cut` command would have created problems. But with semicolon there are no problems  \n\n`cut -d';' -f4,6,8,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,63,66,69,72,75,78,81,84,87,90,93,96,99,102,105,108,111,114,117,120,123,126 output.txt > s_nw.txt`\n\n\n",
    "supporting": [
      "terminal_files"
    ],
    "filters": [],
    "includes": {}
  }
}