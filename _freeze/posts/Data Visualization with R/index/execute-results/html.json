{
  "hash": "6fd2938e42720f79f7eb303adb1e6af5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Themes for Data Visualization with R\"\nauthor: \"Oliver Zingg\"\ndate: \"09.10.2023\"\nimage: \"pic.png\"\n---\n\n\n# Example 1: Save Themes\n\n* https://datavizs23.classes.andrewheiss.com/example/05-example.html\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)  # For ggplot, dplyr, and friends\nlibrary(gapminder)  # For gapminder data\nlibrary(scales)     # For nice axis labels\n\ngapminder_filtered <- gapminder %>% \n  filter(year > 2000)\n\nbase_plot <- ggplot(data = gapminder_filtered,\n                    mapping = aes(x = gdpPercap, y = lifeExp, \n                                  color = continent, size = pop)) +\n  geom_point() +\n  # Use dollars, and get rid of the cents part (i.e. $300 instead of $300.00)\n  scale_x_log10(labels = dollar_format(accuracy = 1)) +\n  # Format with commas\n  scale_size_continuous(labels = comma) +\n  # Use viridis\n  scale_color_viridis_d(option = \"plasma\", end = 0.9) +\n  labs(x = \"GDP per capita\", y = \"Life expectancy\",\n       color = \"Continent\", size = \"Population\",\n       title = \"Here's a cool title\",\n       subtitle = \"And here's a neat subtitle\",\n       caption = \"Source: The Gapminder Project\") +\n  facet_wrap(vars(year))\n```\n:::\n\n\n## Create and save theme (my_pretty_theme)\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_pretty_theme <- theme_minimal(base_family = \"Roboto Condensed\", base_size = 12) +\n  theme(panel.grid.minor = element_blank(),\n        # Bold, bigger title\n        plot.title = element_text(face = \"bold\", size = rel(1.7)),\n        # Plain, slightly bigger subtitle that is grey\n        plot.subtitle = element_text(face = \"plain\", size = rel(1.3), color = \"grey70\"),\n        # Italic, smaller, grey caption that is left-aligned\n        plot.caption = element_text(face = \"italic\", size = rel(0.7), \n                                    color = \"grey70\", hjust = 0),\n        # Bold legend titles\n        legend.title = element_text(face = \"bold\"),\n        # Bold, slightly larger facet titles that are left-aligned for the sake of repetition\n        strip.text = element_text(face = \"bold\", size = rel(1.1), hjust = 0),\n        # Bold axis titles\n        axis.title = element_text(face = \"bold\"),\n        # Add some space above the x-axis title and make it left-aligned\n        axis.title.x = element_text(margin = margin(t = 10), hjust = 0),\n        # Add some space to the right of the y-axis title and make it top-aligned\n        axis.title.y = element_text(margin = margin(r = 10), hjust = 1),\n        # Add a light grey background to the facet titles, with no borders\n        strip.background = element_rect(fill = \"grey90\", color = NA),\n        # Add a thin grey border around all the plots to tie in the facet titles\n        panel.border = element_rect(color = \"grey90\", fill = NA))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbase_plot + \n  my_pretty_theme\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n## Lets make this plot even better :D \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gapminder)\nlibrary(scales)\nlibrary(ggtext)\nlibrary(thematic)\n\ngapminder_filtered <- gapminder %>% \n  filter(year > 2000)\n\ncolors <- thematic::okabe_ito(5)\ntitle_text <- glue::glue(\n  ' Life Expectancy per GDP for <span style = \"color:{colors[1]}\">**Africa**</span>, <span style = \"color:{colors[2]}\">**America**</span>, <span style = \"color:{colors[3]}\">**Asia**</span>, <br> <span style = \"color:{colors[4]}\">**Europa**</span> and <span style = \"color:{colors[5]}\">**Oceania**</span>'\n)\n\nplot_nice <- ggplot(data = gapminder_filtered,\n                    mapping = aes(x = gdpPercap, y = lifeExp, \n                                  color = continent, size = pop)) +\n  geom_point() + \n  # Use dollars, and get rid of the cents part (i.e. $300 instead of $300.00)\n  #log10 scale = abstände nicht gleich(nicht-linear): x-1*x = x+1\n  scale_x_log10(labels = dollar_format(accuracy = 1)) +\n  # Format with commas (anstatt wissenschaftliche Notation für Population)\n  scale_size_continuous(labels = comma) +\n  # Use viridis color\n  scale_color_viridis_d(option = \"plasma\", end = 0.9) +\n  labs(x = \"GDP per capita\", y = \"Life expectancy\",\n       color = \"Continent\", size = \"Population\",\n       title = title_text,\n       subtitle = \"Visible Correlation between GDP (per capita) and Life expecanty\",\n       caption = \"Source: The Gapminder Project\") +\n  facet_wrap(vars(year))+\n\n  theme_minimal(base_family = 'Source Sans Pro', base_size = 12) + \n  #guide = none, legend wird ausgelassen\n  scale_color_manual(values = thematic::okabe_ito(5), guide = \"none\")+\n  #grauere Hintergrund verschwindet+\n  theme(panel.grid.minor = element_blank(),\n  # Plain, slightly bigger subtitle that is grey\n  plot.subtitle = element_text(face = \"plain\", size = rel(1.3), color = \"grey70\"),\n  # Italic, smaller, grey caption that is left-aligned\n  plot.caption = element_text(face = \"italic\", size = rel(0.7), \n                              color = \"grey70\", hjust = 0),\n  #Bold legend titles\n  legend.title = element_text(face = \"bold\"),\n  # Bold, slightly larger facet titles that are left-aligned for the sake of repetition\n  strip.text = element_text(face = \"bold\", size = rel(1.1), hjust = 0, color = \"white\"),\n  plot.title = ggtext::element_markdown(\n    color = 'grey20', family = 'Merriweather', size = rel(1.7),face = \"bold\"\n  ),\n  plot.title.position = \"plot\",\n  # Bold axis titles\n  axis.title = element_text(face = \"bold\"),\n  # Add some space above the x-axis title and make it left-aligned\n  axis.title.x = element_text(margin = margin(t = 10), hjust = 0),\n  # Add some space to the right of the y-axis title and make it top-aligned\n  axis.title.y = element_text(margin = margin(r = 10), hjust = 1, margin (0,4,0,0)),\n  # Add a light grey background to the facet titles, with no borders\n  strip.background = element_rect(fill = \"grey20\", color = NA),\n  # Add a thin grey border around all the plots to tie in the facet titles\n  panel.border = element_rect(color = \"grey20\", fill = NA),\n  legend.position = \"top\",\n  legend.justification = 1)\n\nplot_nice\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n## We can add some annotations\n\nAnnotionations can be great to highlight information that gets lost otherwise. For example we see that South Africa increases its GDP per capita from 2002 to 2007 but life expectancy decreases by 4 years.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#find african country with dip in lifeexp: South Africa(2002: x = 7711 ,y= 53.4; 2007: x = 9270, y = 49.3)\ngapminder_filtered |> \n  filter(continent == \"Africa\" & between(gdpPercap,3000,10000) & between(lifeExp,48,55)) |> arrange(desc(pop))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 6\n  country           continent  year lifeExp      pop gdpPercap\n  <fct>             <fct>     <int>   <dbl>    <int>     <dbl>\n1 South Africa      Africa     2002    53.4 44433622     7711.\n2 South Africa      Africa     2007    49.3 43997828     9270.\n3 Congo, Rep.       Africa     2002    53.0  3328795     3484.\n4 Namibia           Africa     2007    52.9  2055080     4811.\n5 Namibia           Africa     2002    51.5  1972153     4072.\n6 Equatorial Guinea Africa     2002    49.3   495627     7703.\n```\n\n\n:::\n\n```{.r .cell-code}\n# creat df for different arrow coordinations\ndf_2002 <-  gapminder_filtered %>%\n  filter(year == 2002) %>% \n  mutate(\n    start_x = 12000,\n    end_x = 9000,\n    start_y = 55,\n    end_y = 53.4\n  )\n\n# creat df for different arrow coordinations\ndf_2007 <-  gapminder_filtered %>%\n  filter(year == 2007) %>% \n  mutate(\n    start_x = 12000,\n    end_x = 10000,\n    start_y = 55,\n    end_y = 49.3\n  )\n\n\n\nplot_nice_anno <- plot_nice + geom_label(aes(x = 12000, y = 55, label = \"South Africa\"), \n                  hjust = 0, \n                  vjust = 0.5, \n                  lineheight = 0.8,\n                  colour = colors[1], \n                  fill = \"white\", \n                  label.size = NA, \n                  size = 5)   +\n  geom_curve(data = df_2002, aes(x = start_x, y = start_y, xend = end_x, yend = end_y), \n             colour = \"grey20\", \n             size=0.8, \n             curvature = -0.2,\n             arrow = arrow(length = unit(0.03, \"npc\"))) + \n  geom_curve(data = df_2007, aes(x = start_x, y = start_y, xend = end_x, yend = end_y), \n             colour = \"grey20\", \n             size=0.8, \n             curvature = -0.2,\n             arrow = arrow(length = unit(0.03, \"npc\")))\nplot_nice_anno\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n## Lets keep playing around\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_nice_anno +\n  scale_y_continuous(\n    breaks = c(4:7*10, seq(70, 80, by = 2))\n    ) + coord_cartesian(clip = \"off\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=960}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}